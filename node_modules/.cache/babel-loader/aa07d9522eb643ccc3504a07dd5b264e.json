{"ast":null,"code":"import { useRef } from 'react';\nimport useLatest from '../useLatest';\nimport { getTargetElement } from '../utils/domTarget';\nimport isBrowser from '../utils/isBrowser';\nimport useEffectWithTarget from '../utils/useEffectWithTarget';\nvar touchSupported = isBrowser && ( // @ts-ignore\n'ontouchstart' in window || window.DocumentTouch && document instanceof DocumentTouch);\n\nfunction useLongPress(onLongPress, target, _a) {\n  var _b = _a === void 0 ? {} : _a,\n      _c = _b.delay,\n      delay = _c === void 0 ? 300 : _c,\n      onClick = _b.onClick,\n      onLongPressEnd = _b.onLongPressEnd;\n\n  var onLongPressRef = useLatest(onLongPress);\n  var onClickRef = useLatest(onClick);\n  var onLongPressEndRef = useLatest(onLongPressEnd);\n  var timerRef = useRef();\n  var isTriggeredRef = useRef(false);\n  useEffectWithTarget(function () {\n    var targetElement = getTargetElement(target);\n\n    if (!(targetElement === null || targetElement === void 0 ? void 0 : targetElement.addEventListener)) {\n      return;\n    }\n\n    var onStart = function onStart(event) {\n      timerRef.current = setTimeout(function () {\n        onLongPressRef.current(event);\n        isTriggeredRef.current = true;\n      }, delay);\n    };\n\n    var onEnd = function onEnd(event, shouldTriggerClick) {\n      var _a;\n\n      if (shouldTriggerClick === void 0) {\n        shouldTriggerClick = false;\n      }\n\n      if (timerRef.current) {\n        clearTimeout(timerRef.current);\n      }\n\n      if (isTriggeredRef.current) {\n        (_a = onLongPressEndRef.current) === null || _a === void 0 ? void 0 : _a.call(onLongPressEndRef, event);\n      }\n\n      if (shouldTriggerClick && !isTriggeredRef.current && onClickRef.current) {\n        onClickRef.current(event);\n      }\n\n      isTriggeredRef.current = false;\n    };\n\n    var onEndWithClick = function onEndWithClick(event) {\n      return onEnd(event, true);\n    };\n\n    if (!touchSupported) {\n      targetElement.addEventListener('mousedown', onStart);\n      targetElement.addEventListener('mouseup', onEndWithClick);\n      targetElement.addEventListener('mouseleave', onEnd);\n    } else {\n      targetElement.addEventListener('touchstart', onStart);\n      targetElement.addEventListener('touchend', onEndWithClick);\n    }\n\n    return function () {\n      if (timerRef.current) {\n        clearTimeout(timerRef.current);\n        isTriggeredRef.current = false;\n      }\n\n      if (!touchSupported) {\n        targetElement.removeEventListener('mousedown', onStart);\n        targetElement.removeEventListener('mouseup', onEndWithClick);\n        targetElement.removeEventListener('mouseleave', onEnd);\n      } else {\n        targetElement.removeEventListener('touchstart', onStart);\n        targetElement.removeEventListener('touchend', onEndWithClick);\n      }\n    };\n  }, [], target);\n}\n\nexport default useLongPress;","map":{"version":3,"names":["useRef","useLatest","getTargetElement","isBrowser","useEffectWithTarget","touchSupported","window","DocumentTouch","document","useLongPress","onLongPress","target","_a","_b","_c","delay","onClick","onLongPressEnd","onLongPressRef","onClickRef","onLongPressEndRef","timerRef","isTriggeredRef","targetElement","addEventListener","onStart","event","current","setTimeout","onEnd","shouldTriggerClick","clearTimeout","call","onEndWithClick","removeEventListener"],"sources":["/Users/yinyahui/Desktop/weblearn/juejin/react-antd-yyy-zongzi/node_modules/_ahooks@3.4.0@ahooks/es/useLongPress/index.js"],"sourcesContent":["import { useRef } from 'react';\nimport useLatest from '../useLatest';\nimport { getTargetElement } from '../utils/domTarget';\nimport isBrowser from '../utils/isBrowser';\nimport useEffectWithTarget from '../utils/useEffectWithTarget';\nvar touchSupported = isBrowser && ( // @ts-ignore\n'ontouchstart' in window || window.DocumentTouch && document instanceof DocumentTouch);\n\nfunction useLongPress(onLongPress, target, _a) {\n  var _b = _a === void 0 ? {} : _a,\n      _c = _b.delay,\n      delay = _c === void 0 ? 300 : _c,\n      onClick = _b.onClick,\n      onLongPressEnd = _b.onLongPressEnd;\n\n  var onLongPressRef = useLatest(onLongPress);\n  var onClickRef = useLatest(onClick);\n  var onLongPressEndRef = useLatest(onLongPressEnd);\n  var timerRef = useRef();\n  var isTriggeredRef = useRef(false);\n  useEffectWithTarget(function () {\n    var targetElement = getTargetElement(target);\n\n    if (!(targetElement === null || targetElement === void 0 ? void 0 : targetElement.addEventListener)) {\n      return;\n    }\n\n    var onStart = function onStart(event) {\n      timerRef.current = setTimeout(function () {\n        onLongPressRef.current(event);\n        isTriggeredRef.current = true;\n      }, delay);\n    };\n\n    var onEnd = function onEnd(event, shouldTriggerClick) {\n      var _a;\n\n      if (shouldTriggerClick === void 0) {\n        shouldTriggerClick = false;\n      }\n\n      if (timerRef.current) {\n        clearTimeout(timerRef.current);\n      }\n\n      if (isTriggeredRef.current) {\n        (_a = onLongPressEndRef.current) === null || _a === void 0 ? void 0 : _a.call(onLongPressEndRef, event);\n      }\n\n      if (shouldTriggerClick && !isTriggeredRef.current && onClickRef.current) {\n        onClickRef.current(event);\n      }\n\n      isTriggeredRef.current = false;\n    };\n\n    var onEndWithClick = function onEndWithClick(event) {\n      return onEnd(event, true);\n    };\n\n    if (!touchSupported) {\n      targetElement.addEventListener('mousedown', onStart);\n      targetElement.addEventListener('mouseup', onEndWithClick);\n      targetElement.addEventListener('mouseleave', onEnd);\n    } else {\n      targetElement.addEventListener('touchstart', onStart);\n      targetElement.addEventListener('touchend', onEndWithClick);\n    }\n\n    return function () {\n      if (timerRef.current) {\n        clearTimeout(timerRef.current);\n        isTriggeredRef.current = false;\n      }\n\n      if (!touchSupported) {\n        targetElement.removeEventListener('mousedown', onStart);\n        targetElement.removeEventListener('mouseup', onEndWithClick);\n        targetElement.removeEventListener('mouseleave', onEnd);\n      } else {\n        targetElement.removeEventListener('touchstart', onStart);\n        targetElement.removeEventListener('touchend', onEndWithClick);\n      }\n    };\n  }, [], target);\n}\n\nexport default useLongPress;"],"mappings":"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"},"metadata":{},"sourceType":"module"}