{"ast":null,"code":"import classNames from 'classnames';\nimport React, { useState, useRef } from 'react';\nimport { useUnmountedRef } from 'ahooks';\nimport { withNativeProps } from '../../utils/native-props';\nimport { mergeProps } from '../../utils/with-default-props';\nimport Mask from '../mask';\nimport { useLockScroll } from '../../utils/use-lock-scroll';\nimport { renderToContainer } from '../../utils/render-to-container';\nimport { useSpring, animated } from '@react-spring/web';\nimport { useShouldRender } from '../../utils/should-render';\nimport { withStopPropagation } from '../../utils/with-stop-propagation';\nconst classPrefix = `adm-popup`;\nconst defaultProps = {\n  position: 'bottom',\n  visible: false,\n  getContainer: () => document.body,\n  mask: true,\n  stopPropagation: ['click']\n};\nexport const Popup = p => {\n  const props = mergeProps(defaultProps, p);\n  const bodyCls = classNames(`${classPrefix}-body`, props.bodyClassName, `${classPrefix}-body-position-${props.position}`);\n  const ref = useRef(null);\n  const [active, setActive] = useState(props.visible);\n  useLockScroll(ref, active);\n  const shouldRender = useShouldRender(active, props.forceRender, props.destroyOnClose);\n  const unmountedRef = useUnmountedRef();\n  const {\n    percent\n  } = useSpring({\n    percent: props.visible ? 0 : 100,\n    config: {\n      precision: 0.1,\n      mass: 0.4,\n      tension: 300,\n      friction: 30\n    },\n    onStart: () => {\n      setActive(true);\n    },\n    onRest: () => {\n      var _a, _b;\n\n      if (unmountedRef.current) return;\n      setActive(props.visible);\n\n      if (props.visible) {\n        (_a = props.afterShow) === null || _a === void 0 ? void 0 : _a.call(props);\n      } else {\n        (_b = props.afterClose) === null || _b === void 0 ? void 0 : _b.call(props);\n      }\n    }\n  });\n  const node = withStopPropagation(props.stopPropagation, withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix,\n    onClick: props.onClick,\n    style: {\n      display: active ? undefined : 'none'\n    }\n  }, props.mask && React.createElement(Mask, {\n    visible: props.visible,\n    onMaskClick: props.onMaskClick,\n    className: props.maskClassName,\n    style: props.maskStyle,\n    disableBodyScroll: false,\n    stopPropagation: props.stopPropagation\n  }), React.createElement(animated.div, {\n    className: bodyCls,\n    style: Object.assign(Object.assign({}, props.bodyStyle), {\n      transform: percent.to(v => {\n        if (props.position === 'bottom') {\n          return `translate(0, ${v}%)`;\n        }\n\n        if (props.position === 'top') {\n          return `translate(0, -${v}%)`;\n        }\n\n        if (props.position === 'left') {\n          return `translate(-${v}%, 0)`;\n        }\n\n        if (props.position === 'right') {\n          return `translate(${v}%, 0)`;\n        }\n\n        return 'none';\n      })\n    }),\n    ref: ref\n  }, shouldRender && props.children))));\n  return renderToContainer(props.getContainer, node);\n};","map":{"version":3,"names":["classNames","React","useState","useRef","useUnmountedRef","withNativeProps","mergeProps","Mask","useLockScroll","renderToContainer","useSpring","animated","useShouldRender","withStopPropagation","classPrefix","defaultProps","position","visible","getContainer","document","body","mask","stopPropagation","Popup","p","props","bodyCls","bodyClassName","ref","active","setActive","shouldRender","forceRender","destroyOnClose","unmountedRef","percent","config","precision","mass","tension","friction","onStart","onRest","_a","_b","current","afterShow","call","afterClose","node","createElement","className","onClick","style","display","undefined","onMaskClick","maskClassName","maskStyle","disableBodyScroll","div","Object","assign","bodyStyle","transform","to","v","children"],"sources":["/Users/yinyahui/Desktop/weblearn/juejin/react-antd-yyy-zongzi/node_modules/_antd-mobile@5.12.6@antd-mobile/es/components/popup/popup.js"],"sourcesContent":["import classNames from 'classnames';\nimport React, { useState, useRef } from 'react';\nimport { useUnmountedRef } from 'ahooks';\nimport { withNativeProps } from '../../utils/native-props';\nimport { mergeProps } from '../../utils/with-default-props';\nimport Mask from '../mask';\nimport { useLockScroll } from '../../utils/use-lock-scroll';\nimport { renderToContainer } from '../../utils/render-to-container';\nimport { useSpring, animated } from '@react-spring/web';\nimport { useShouldRender } from '../../utils/should-render';\nimport { withStopPropagation } from '../../utils/with-stop-propagation';\nconst classPrefix = `adm-popup`;\nconst defaultProps = {\n  position: 'bottom',\n  visible: false,\n  getContainer: () => document.body,\n  mask: true,\n  stopPropagation: ['click']\n};\nexport const Popup = p => {\n  const props = mergeProps(defaultProps, p);\n  const bodyCls = classNames(`${classPrefix}-body`, props.bodyClassName, `${classPrefix}-body-position-${props.position}`);\n  const ref = useRef(null);\n  const [active, setActive] = useState(props.visible);\n  useLockScroll(ref, active);\n  const shouldRender = useShouldRender(active, props.forceRender, props.destroyOnClose);\n  const unmountedRef = useUnmountedRef();\n  const {\n    percent\n  } = useSpring({\n    percent: props.visible ? 0 : 100,\n    config: {\n      precision: 0.1,\n      mass: 0.4,\n      tension: 300,\n      friction: 30\n    },\n    onStart: () => {\n      setActive(true);\n    },\n    onRest: () => {\n      var _a, _b;\n\n      if (unmountedRef.current) return;\n      setActive(props.visible);\n\n      if (props.visible) {\n        (_a = props.afterShow) === null || _a === void 0 ? void 0 : _a.call(props);\n      } else {\n        (_b = props.afterClose) === null || _b === void 0 ? void 0 : _b.call(props);\n      }\n    }\n  });\n  const node = withStopPropagation(props.stopPropagation, withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix,\n    onClick: props.onClick,\n    style: {\n      display: active ? undefined : 'none'\n    }\n  }, props.mask && React.createElement(Mask, {\n    visible: props.visible,\n    onMaskClick: props.onMaskClick,\n    className: props.maskClassName,\n    style: props.maskStyle,\n    disableBodyScroll: false,\n    stopPropagation: props.stopPropagation\n  }), React.createElement(animated.div, {\n    className: bodyCls,\n    style: Object.assign(Object.assign({}, props.bodyStyle), {\n      transform: percent.to(v => {\n        if (props.position === 'bottom') {\n          return `translate(0, ${v}%)`;\n        }\n\n        if (props.position === 'top') {\n          return `translate(0, -${v}%)`;\n        }\n\n        if (props.position === 'left') {\n          return `translate(-${v}%, 0)`;\n        }\n\n        if (props.position === 'right') {\n          return `translate(${v}%, 0)`;\n        }\n\n        return 'none';\n      })\n    }),\n    ref: ref\n  }, shouldRender && props.children))));\n  return renderToContainer(props.getContainer, node);\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}