{"ast":null,"code":"import React, { useState, useEffect, forwardRef, useImperativeHandle, memo } from 'react';\nimport classNames from 'classnames';\nimport Popup from '../popup';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { withNativeProps } from '../../utils/native-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport PickerView from '../picker-view';\nimport { generateColumnsExtend, useColumnsExtend } from '../picker-view/columns-extend';\nimport { useConfig } from '../config-provider';\nimport { useMemoizedFn } from 'ahooks';\nimport SafeArea from '../safe-area';\nimport { defaultRenderLabel } from './picker-utils';\nimport { useShouldRender } from '../../utils/should-render';\nconst classPrefix = `adm-picker`;\nconst defaultProps = {\n  defaultValue: [],\n  closeOnMaskClick: true,\n  renderLabel: defaultRenderLabel\n};\nexport const Picker = memo(forwardRef((p, ref) => {\n  var _a;\n\n  const {\n    locale\n  } = useConfig();\n  const props = mergeProps(defaultProps, {\n    confirmText: locale.common.confirm,\n    cancelText: locale.common.cancel\n  }, p);\n  const [visible, setVisible] = usePropsValue({\n    value: props.visible,\n    defaultValue: false,\n    onChange: v => {\n      var _a;\n\n      if (v === false) {\n        (_a = props.onClose) === null || _a === void 0 ? void 0 : _a.call(props);\n      }\n    }\n  });\n  const actions = {\n    toggle: () => {\n      setVisible(v => !v);\n    },\n    open: () => {\n      setVisible(true);\n    },\n    close: () => {\n      setVisible(false);\n    }\n  };\n  useImperativeHandle(ref, () => actions);\n  const [value, setValue] = usePropsValue(Object.assign(Object.assign({}, props), {\n    onChange: val => {\n      var _a;\n\n      const extend = generateColumnsExtend(props.columns, val);\n      (_a = props.onConfirm) === null || _a === void 0 ? void 0 : _a.call(props, val, extend);\n    }\n  }));\n  const extend = useColumnsExtend(props.columns, value);\n  const [innerValue, setInnerValue] = useState(value);\n  useEffect(() => {\n    if (innerValue !== value) {\n      setInnerValue(value);\n    }\n  }, [visible]);\n  useEffect(() => {\n    if (!visible) {\n      setInnerValue(value);\n    }\n  }, [value]);\n  const onChange = useMemoizedFn((val, ext) => {\n    var _a;\n\n    setInnerValue(val);\n\n    if (visible) {\n      (_a = props.onSelect) === null || _a === void 0 ? void 0 : _a.call(props, val, ext);\n    }\n  });\n  const shouldRender = useShouldRender(visible, props.forceRender, props.destroyOnClose);\n  const pickerElement = withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-header`\n  }, React.createElement(\"a\", {\n    className: `${classPrefix}-header-button`,\n    onClick: () => {\n      var _a;\n\n      (_a = props.onCancel) === null || _a === void 0 ? void 0 : _a.call(props);\n      setVisible(false);\n    }\n  }, props.cancelText), React.createElement(\"div\", {\n    className: `${classPrefix}-header-title`\n  }, props.title), React.createElement(\"a\", {\n    className: `${classPrefix}-header-button`,\n    onClick: () => {\n      setValue(innerValue);\n      setVisible(false);\n    }\n  }, props.confirmText)), React.createElement(\"div\", {\n    className: `${classPrefix}-body`\n  }, React.createElement(PickerView, {\n    columns: props.columns,\n    renderLabel: props.renderLabel,\n    value: innerValue,\n    mouseWheel: props.mouseWheel,\n    onChange: onChange\n  }))));\n  const popupElement = React.createElement(Popup, {\n    style: props.popupStyle,\n    className: classNames(`${classPrefix}-popup`, props.popupClassName),\n    visible: visible,\n    position: 'bottom',\n    onMaskClick: () => {\n      var _a;\n\n      if (!props.closeOnMaskClick) return;\n      (_a = props.onCancel) === null || _a === void 0 ? void 0 : _a.call(props);\n      setVisible(false);\n    },\n    getContainer: props.getContainer,\n    destroyOnClose: true,\n    afterShow: props.afterShow,\n    afterClose: props.afterClose,\n    onClick: props.onClick,\n    forceRender: true,\n    stopPropagation: props.stopPropagation\n  }, shouldRender && pickerElement, React.createElement(SafeArea, {\n    position: 'bottom'\n  }));\n  return React.createElement(React.Fragment, null, popupElement, (_a = props.children) === null || _a === void 0 ? void 0 : _a.call(props, extend.items, actions));\n}));\nPicker.displayName = 'Picker';","map":{"version":3,"names":["React","useState","useEffect","forwardRef","useImperativeHandle","memo","classNames","Popup","mergeProps","withNativeProps","usePropsValue","PickerView","generateColumnsExtend","useColumnsExtend","useConfig","useMemoizedFn","SafeArea","defaultRenderLabel","useShouldRender","classPrefix","defaultProps","defaultValue","closeOnMaskClick","renderLabel","Picker","p","ref","_a","locale","props","confirmText","common","confirm","cancelText","cancel","visible","setVisible","value","onChange","v","onClose","call","actions","toggle","open","close","setValue","Object","assign","val","extend","columns","onConfirm","innerValue","setInnerValue","ext","onSelect","shouldRender","forceRender","destroyOnClose","pickerElement","createElement","className","onClick","onCancel","title","mouseWheel","popupElement","style","popupStyle","popupClassName","position","onMaskClick","getContainer","afterShow","afterClose","stopPropagation","Fragment","children","items","displayName"],"sources":["/Users/yinyahui/Desktop/weblearn/juejin/react-antd-manage/react-antd-manage/node_modules/_antd-mobile@5.12.6@antd-mobile/es/components/picker/picker.js"],"sourcesContent":["import React, { useState, useEffect, forwardRef, useImperativeHandle, memo } from 'react';\nimport classNames from 'classnames';\nimport Popup from '../popup';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { withNativeProps } from '../../utils/native-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport PickerView from '../picker-view';\nimport { generateColumnsExtend, useColumnsExtend } from '../picker-view/columns-extend';\nimport { useConfig } from '../config-provider';\nimport { useMemoizedFn } from 'ahooks';\nimport SafeArea from '../safe-area';\nimport { defaultRenderLabel } from './picker-utils';\nimport { useShouldRender } from '../../utils/should-render';\nconst classPrefix = `adm-picker`;\nconst defaultProps = {\n  defaultValue: [],\n  closeOnMaskClick: true,\n  renderLabel: defaultRenderLabel\n};\nexport const Picker = memo(forwardRef((p, ref) => {\n  var _a;\n\n  const {\n    locale\n  } = useConfig();\n  const props = mergeProps(defaultProps, {\n    confirmText: locale.common.confirm,\n    cancelText: locale.common.cancel\n  }, p);\n  const [visible, setVisible] = usePropsValue({\n    value: props.visible,\n    defaultValue: false,\n    onChange: v => {\n      var _a;\n\n      if (v === false) {\n        (_a = props.onClose) === null || _a === void 0 ? void 0 : _a.call(props);\n      }\n    }\n  });\n  const actions = {\n    toggle: () => {\n      setVisible(v => !v);\n    },\n    open: () => {\n      setVisible(true);\n    },\n    close: () => {\n      setVisible(false);\n    }\n  };\n  useImperativeHandle(ref, () => actions);\n  const [value, setValue] = usePropsValue(Object.assign(Object.assign({}, props), {\n    onChange: val => {\n      var _a;\n\n      const extend = generateColumnsExtend(props.columns, val);\n      (_a = props.onConfirm) === null || _a === void 0 ? void 0 : _a.call(props, val, extend);\n    }\n  }));\n  const extend = useColumnsExtend(props.columns, value);\n  const [innerValue, setInnerValue] = useState(value);\n  useEffect(() => {\n    if (innerValue !== value) {\n      setInnerValue(value);\n    }\n  }, [visible]);\n  useEffect(() => {\n    if (!visible) {\n      setInnerValue(value);\n    }\n  }, [value]);\n  const onChange = useMemoizedFn((val, ext) => {\n    var _a;\n\n    setInnerValue(val);\n\n    if (visible) {\n      (_a = props.onSelect) === null || _a === void 0 ? void 0 : _a.call(props, val, ext);\n    }\n  });\n  const shouldRender = useShouldRender(visible, props.forceRender, props.destroyOnClose);\n  const pickerElement = withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-header`\n  }, React.createElement(\"a\", {\n    className: `${classPrefix}-header-button`,\n    onClick: () => {\n      var _a;\n\n      (_a = props.onCancel) === null || _a === void 0 ? void 0 : _a.call(props);\n      setVisible(false);\n    }\n  }, props.cancelText), React.createElement(\"div\", {\n    className: `${classPrefix}-header-title`\n  }, props.title), React.createElement(\"a\", {\n    className: `${classPrefix}-header-button`,\n    onClick: () => {\n      setValue(innerValue);\n      setVisible(false);\n    }\n  }, props.confirmText)), React.createElement(\"div\", {\n    className: `${classPrefix}-body`\n  }, React.createElement(PickerView, {\n    columns: props.columns,\n    renderLabel: props.renderLabel,\n    value: innerValue,\n    mouseWheel: props.mouseWheel,\n    onChange: onChange\n  }))));\n  const popupElement = React.createElement(Popup, {\n    style: props.popupStyle,\n    className: classNames(`${classPrefix}-popup`, props.popupClassName),\n    visible: visible,\n    position: 'bottom',\n    onMaskClick: () => {\n      var _a;\n\n      if (!props.closeOnMaskClick) return;\n      (_a = props.onCancel) === null || _a === void 0 ? void 0 : _a.call(props);\n      setVisible(false);\n    },\n    getContainer: props.getContainer,\n    destroyOnClose: true,\n    afterShow: props.afterShow,\n    afterClose: props.afterClose,\n    onClick: props.onClick,\n    forceRender: true,\n    stopPropagation: props.stopPropagation\n  }, shouldRender && pickerElement, React.createElement(SafeArea, {\n    position: 'bottom'\n  }));\n  return React.createElement(React.Fragment, null, popupElement, (_a = props.children) === null || _a === void 0 ? void 0 : _a.call(props, extend.items, actions));\n}));\nPicker.displayName = 'Picker';"],"mappings":"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"},"metadata":{},"sourceType":"module"}