{"ast":null,"code":"import React, { createRef, forwardRef, useEffect, useImperativeHandle, useState } from 'react';\nimport { resolveContainer } from '../../utils/get-container';\nimport { InternalToast } from './toast';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { render, unmount as reactUnmount } from '../../utils/render';\nconst containers = [];\n\nfunction unmount(container) {\n  const unmountResult = reactUnmount(container);\n\n  if (unmountResult && container.parentNode) {\n    container.parentNode.removeChild(container);\n  }\n}\n\nconst defaultProps = {\n  duration: 2000,\n  position: 'center',\n  maskClickable: true\n};\nexport function show(p) {\n  const props = mergeProps(defaultProps, typeof p === 'string' ? {\n    content: p\n  } : p);\n  let timer = 0;\n  const {\n    getContainer = () => document.body\n  } = props;\n  const container = document.createElement('div');\n  const bodyContainer = resolveContainer(getContainer);\n  bodyContainer.appendChild(container);\n  clear();\n  containers.push(container);\n  const TempToast = forwardRef((_, ref) => {\n    const [visible, setVisible] = useState(true);\n    useEffect(() => {\n      return () => {\n        var _a;\n\n        (_a = props.afterClose) === null || _a === void 0 ? void 0 : _a.call(props);\n      };\n    }, []);\n    useEffect(() => {\n      if (props.duration === 0) {\n        return;\n      }\n\n      timer = window.setTimeout(() => {\n        setVisible(false);\n      }, props.duration);\n      return () => {\n        window.clearTimeout(timer);\n      };\n    }, []);\n    useImperativeHandle(ref, () => ({\n      close: () => setVisible(false)\n    }));\n    return React.createElement(InternalToast, Object.assign({}, props, {\n      getContainer: () => container,\n      visible: visible,\n      afterClose: () => {\n        unmount(container);\n      }\n    }));\n  });\n  const ref = createRef();\n  render(React.createElement(TempToast, {\n    ref: ref\n  }), container);\n  return {\n    close: () => {\n      var _a;\n\n      (_a = ref.current) === null || _a === void 0 ? void 0 : _a.close();\n    }\n  };\n}\nexport function clear() {\n  while (true) {\n    const container = containers.pop();\n    if (!container) break;\n    unmount(container);\n  }\n}\nexport function config(val) {\n  if (val.duration !== undefined) {\n    defaultProps.duration = val.duration;\n  }\n\n  if (val.position !== undefined) {\n    defaultProps.position = val.position;\n  }\n\n  if (val.maskClickable !== undefined) {\n    defaultProps.maskClickable = val.maskClickable;\n  }\n}","map":{"version":3,"names":["React","createRef","forwardRef","useEffect","useImperativeHandle","useState","resolveContainer","InternalToast","mergeProps","render","unmount","reactUnmount","containers","container","unmountResult","parentNode","removeChild","defaultProps","duration","position","maskClickable","show","p","props","content","timer","getContainer","document","body","createElement","bodyContainer","appendChild","clear","push","TempToast","_","ref","visible","setVisible","_a","afterClose","call","window","setTimeout","clearTimeout","close","Object","assign","current","pop","config","val","undefined"],"sources":["/Users/yinyahui/Desktop/weblearn/juejin/react-antd-yyy-zongzi/node_modules/_antd-mobile@5.12.6@antd-mobile/es/components/toast/methods.js"],"sourcesContent":["import React, { createRef, forwardRef, useEffect, useImperativeHandle, useState } from 'react';\nimport { resolveContainer } from '../../utils/get-container';\nimport { InternalToast } from './toast';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { render, unmount as reactUnmount } from '../../utils/render';\nconst containers = [];\n\nfunction unmount(container) {\n  const unmountResult = reactUnmount(container);\n\n  if (unmountResult && container.parentNode) {\n    container.parentNode.removeChild(container);\n  }\n}\n\nconst defaultProps = {\n  duration: 2000,\n  position: 'center',\n  maskClickable: true\n};\nexport function show(p) {\n  const props = mergeProps(defaultProps, typeof p === 'string' ? {\n    content: p\n  } : p);\n  let timer = 0;\n  const {\n    getContainer = () => document.body\n  } = props;\n  const container = document.createElement('div');\n  const bodyContainer = resolveContainer(getContainer);\n  bodyContainer.appendChild(container);\n  clear();\n  containers.push(container);\n  const TempToast = forwardRef((_, ref) => {\n    const [visible, setVisible] = useState(true);\n    useEffect(() => {\n      return () => {\n        var _a;\n\n        (_a = props.afterClose) === null || _a === void 0 ? void 0 : _a.call(props);\n      };\n    }, []);\n    useEffect(() => {\n      if (props.duration === 0) {\n        return;\n      }\n\n      timer = window.setTimeout(() => {\n        setVisible(false);\n      }, props.duration);\n      return () => {\n        window.clearTimeout(timer);\n      };\n    }, []);\n    useImperativeHandle(ref, () => ({\n      close: () => setVisible(false)\n    }));\n    return React.createElement(InternalToast, Object.assign({}, props, {\n      getContainer: () => container,\n      visible: visible,\n      afterClose: () => {\n        unmount(container);\n      }\n    }));\n  });\n  const ref = createRef();\n  render(React.createElement(TempToast, {\n    ref: ref\n  }), container);\n  return {\n    close: () => {\n      var _a;\n\n      (_a = ref.current) === null || _a === void 0 ? void 0 : _a.close();\n    }\n  };\n}\nexport function clear() {\n  while (true) {\n    const container = containers.pop();\n    if (!container) break;\n    unmount(container);\n  }\n}\nexport function config(val) {\n  if (val.duration !== undefined) {\n    defaultProps.duration = val.duration;\n  }\n\n  if (val.position !== undefined) {\n    defaultProps.position = val.position;\n  }\n\n  if (val.maskClickable !== undefined) {\n    defaultProps.maskClickable = val.maskClickable;\n  }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}